<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Evolving Circles</title>
</head>
<body>

<script src="vec2.js"></script>
<script src="random.js"></script>
<script src="fitnessgraph.js"></script>

<canvas id="canvas" width="1024" height="600"></canvas>
<br>
<button onclick="onRestartButton()">Restart</button>
<br>
Population size: <input type="number" id="ID_POP_SIZE" min="0" value="1000"><br>
Generations/tick: <input type="number" id="ID_GENS_TICK" min="0" value="1"><br>
Number of circles: <input type="number" id="ID_NUM_CIRCLES" min="0" value="3"><br>
<br>
Mutation spread: <input type="number" id="ID_MUTATION_SPREAD" min="0" value="25"><br>
Mutation half-life (#generations, 0 to disable): <input type="number" id="ID_MUTATION_HALFLIFE" min="0" value="100">

<script>

let g_pop_size = 0;
let g_gens_tick = 0;
let g_num_circles = 0;
let g_mutation_spread = 0;
let g_mutation_halflife = 0;

function read_parameters() {
	g_pop_size = parseFloat(document.getElementById("ID_POP_SIZE").value);
	g_gens_tick = parseFloat(document.getElementById("ID_GENS_TICK").value);
	g_num_circles = parseFloat(document.getElementById("ID_NUM_CIRCLES").value);
	g_mutation_spread = parseFloat(document.getElementById("ID_MUTATION_SPREAD").value);
	g_mutation_halflife = parseFloat(document.getElementById("ID_MUTATION_HALFLIFE").value);
}
read_parameters();

const g_fitnessgraph = new FitnessGraph( 0, 500, canvas.width, 100 );

let frame = 1;
window.onload = function()
{
	const canvas = document.getElementById('canvas');
	const context = canvas.getContext('2d');

	(function drawFrame () {
		window.requestAnimationFrame( drawFrame, canvas );
		context.clearRect( 0, 0, canvas.width, canvas.height );
		frame += 1;

		g_fitnessgraph.push( 1000000000 - 10000 * frame );
		g_fitnessgraph.draw( context );
	}());
}

function onRestartButton()
{
	g_fitnessgraph.clear();
}

</script>
</body>
</html>
